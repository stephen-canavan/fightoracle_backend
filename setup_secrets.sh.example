#!/bin/bash
# Example script for setting up secure secrets on your VPS
# DO NOT RUN THIS DIRECTLY - Use as a reference and customize for your setup

# Colors for output
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${YELLOW}Setting up secure secrets management...${NC}"

# Create directory for environment file
sudo mkdir -p /etc/fight_predictor

# Create environment file (you'll need to edit this with your actual values)
sudo tee /etc/fight_predictor/env > /dev/null <<EOF
SECRET_KEY=$(python3 -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())')
DEBUG=False
ALLOWED_HOSTS=yourdomain.com,www.yourdomain.com
DATABASE_URL=postgresql://fight_predictor_user:YOUR_PASSWORD@localhost:5432/fight_predictor
CORS_ALLOWED_ORIGINS=https://your-frontend-domain.com
SECURE_COOKIE=True
SECURE_SSL_REDIRECT=True
JWT_ACCESS_TOKEN_LIFETIME_MINUTES=15
JWT_REFRESH_TOKEN_LIFETIME_DAYS=7
EOF

# Set restrictive permissions (owner read/write only)
sudo chmod 600 /etc/fight_predictor/env

# Set ownership to your app user (replace 'fight_predictor' with your user)
sudo chown fight_predictor:fight_predictor /etc/fight_predictor/env

echo -e "${GREEN}✓ Environment file created at /etc/fight_predictor/env${NC}"
echo -e "${YELLOW}⚠ Remember to edit /etc/fight_predictor/env with your actual values!${NC}"
echo -e "${YELLOW}⚠ Replace YOUR_PASSWORD with your actual database password${NC}"
echo -e "${YELLOW}⚠ Update ALLOWED_HOSTS and CORS_ALLOWED_ORIGINS with your domains${NC}"

# Verify permissions
echo -e "\n${GREEN}Verifying permissions:${NC}"
ls -la /etc/fight_predictor/env

echo -e "\n${GREEN}Setup complete!${NC}"
echo -e "${YELLOW}Next steps:${NC}"
echo "1. Edit /etc/fight_predictor/env with your actual values"
echo "2. Update your systemd service file to use EnvironmentFile=/etc/fight_predictor/env"
echo "3. Reload systemd: sudo systemctl daemon-reload"
echo "4. Restart your service: sudo systemctl restart fight_predictor"

